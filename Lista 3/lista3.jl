#=
##### LISTA 3 #####

### Exercício 1 ###

x| 5.9  | 6  | 6.1  | 6.2  |
-|------|----|------|------|
y| 34.8 | 36 | 37.2 | 38.4 |

i)

P₃(xᵢ) = yᵢ
=>

a₀ + a₁(5.9) + a₂(5.9)² + a₃(5.9)³ = 34.8

a₀ + a₁(6) + a₂(6)² + a₃(6)³ = 36

a₀ + a₁(6.1) + a₂(6.1)² + a₃(6.1)³ = 37.2

a₀ + a₁(6.2) + a₂(6.2)² + a₃(6.2)³ = 38.4

| 1  5.9  34.81  205.379 |     | a₀ |     | 34.8 |
| 1  6    36     216     |  x  | a₁ |  =  | 36   |
| 1  6.1  37.21  226.981 |     | a₂ |     | 37.2 |
| 1  6.2  38.44  238.328 |     | a₃ |     | 38.4 |

Resolvendo o sistema linear:

| a₀ |     | -36 |
| a₁ |  =  |  12 |
| a₂ |     |   0 |
| a₃ |     |   0 |

Ou seja, P₃(x) = -36 + 12x

ii)

P₃(x) = y₀L₀(x) + y₁L₁(x) + y₂L₂(x) + y₃L₃(x), com:

L₀(x) =    (x - 6)(x - 6.1)(x - 6.2)       x³ - 18.3x² + 111.62x - 226.92 
        ------------------------------- = --------------------------------
        (5.9 - 6)(5.9 - 6.1)(5.9 - 6.2)               -0.006

L₁(x) =    (x - 5.9)(x - 6.1)(x - 6.2)     x³ - 18.2x² + 110.39x - 223.138 
        ------------------------------- = --------------------------------
           (6 - 5.9)(6 - 6.1)(6 - 6.2)                 0.002

L₂(x) =    (x - 5.9)(x - 6)(x - 6.2)       x³ - 18.1x² + 109.18x - 219.48 
        ------------------------------- = --------------------------------
        (6.1 - 5.9)(6.1 - 6)(6.1 - 6.2)               -0.002

L₃(x) =    (x - 5.9)(x - 6)(x - 6.1)        x³ - 18x² + 107.99x - 215.94 
        ------------------------------- = --------------------------------
        (6.2 - 5.9)(6.2 - 6)(6.2 - 6.1)                0.006

=>

P₃(x) = -5800(x³ - 18.3x² + 111.62x - 226.92) 
      + 18000(x³ - 18.2x² + 110.39x - 223.138)
      - 18600(x³ - 18.1x² + 109.18x - 219.48)
      + 6400(x³ - 18x² + 107.99x - 215.94)

=>

P₃(x) = 0x³ + 0x² + 12x - 36 

=>

P₃(x) = 12x - 36

iii)

P₃(x) = d₀ + d₁(x - 5.9) + d₂(x - 5.9)(x - 6) + d3(x - 5.9)(x - 6)(x - 6.1)

=>

P₃(x) = d₀ + d₁(x - 5.9) + d₂(x² - 11.9x + 35.4) + d3(x³ - 18x² + 107.99 - 215.94)

Com dᵢ igual a:

   x    | θ(0)  | θ(1)  | θ(2)  | θ(3)  |
--------|-------|-------|-------|-------|
x₀ = 5.9| 34.8  |       |       |       |   
        |       |  12   |       |       |
x₁ = 6  | 36    |       |  0    |       | 
        |       |  12   |       | 0     | 
x₂ = 6.1| 37.2  |       |  0    |       | 
        |       |  12   |       |       |  
x₃ = 6.2| 38.4  |       |       |       | 

Ou seja, d₀ = 34.8, d₁ = 12, d₂ = d₃ = 0

Logo P₃(x) = 34.8 + 12(x - 5.9) + 0(x² - 11.9x + 35.4) + 0(x³ - 18x² + 107.99 -215.94)
=>
P₃(x) = 34.8 + 12x - 70.8 = 12x - 36


Conclusão:
Como esperado, dado o fato de que há somente um polinômio que interpola os pontos dados,
os três métodos resultaram no mesmo polinômio, P(x) = 12x - 36.

### Exercício 2 ###

x|   2    |  2.2   |  2.4   |  2.6   |  2.8   |
-|--------|--------|--------|--------|--------|
y| 0.5103 | 0.5208 | 0.5104 | 0.4813 | 0.4359 |

Utilizando, primeiramente Lagrange:

-> Grau 2:
   Considerando os pontos mais próximos de 2.5, de modo que se tenham n + 1 = 3 pares 
   ordenados, construíremos o polinômio com:
 
   x|  2.2   |  2.4   |  2.6   |
   -|--------|--------|--------|
   y| 0.5208 | 0.5104 | 0.4813 |

   Assim, P₂(x) = y₀L₀(x) + y₁L₁(x) + y₂L₂(x), com:

   L₀(x) =    (x - 2.4)(x - 2.6)       x² - 5x + 6.24
           ---------------------- = -----------------------
            (2.2 - 2.4)(2.2 - 2.6)           0.08   

   L₁(x) =    (x - 2.2)(x - 2.6)       x² - 4.8x + 5.72
           ---------------------- = -----------------------
            (2.4 - 2.2)(2.4 - 2.6)          -0.04

   L₂(x) =    (x - 2.2)(x - 2.4)       x² - 4.6x + 5.28
           ---------------------- = -----------------------
            (2.6 - 2.2)(2.6 - 2.4)          0.08  

=>

P₂(x) = 6.51(x² - 5x + 6.24) 
      - 12.76(x² - 4.8x + 5.72) 
      + 6.01625(x² - 4.6x + 5.28)

=> P₂(x) = -0.23375x² + 1.11675x - 0.813

Fazendo P₂(2.5) obtemos 0.4981875.

-> Grau 3:
   
   Utilizando os pontos abaixo para construir o Lagrangiano de grau 3 temos:

   x|   2    |  2.2   |  2.4   |  2.6   |
   -|--------|--------|--------|--------|
   y| 0.5103 | 0.5208 | 0.5104 | 0.4813 |

P₃(x) = y₀L₀(x) + y₁L₁(x) + y₂L₂(x) + y₃L₃(x), com:

L₀(x) =    (x - 2.2)(x - 2.4)(x - 2.6)      x³ - 7.2x² + 17.24x - 13.728
        ------------------------------- = --------------------------------
           (2 - 2.2)(2 - 2.4)(2 - 2.6)               -0.048

L₁(x) =    (x - 2)(x - 2.4)(x - 2.6)          x³ - 7x² + 16.24x - 12.48
        --------------------------------- = -----------------------------
         (2.2 - 2)(2.2 - 2.4)(2.2 - 2.6)              0.016   

L₂(x) =    (x - 2)(x - 2.2)(x - 2.6)        x³ - 6.8x² + 15.32x - 11.44
        ------------------------------- = --------------------------------
        (2.4 - 2)(2.4 - 2.2)(2.4 - 2.6)              -0.016

L₃(x) =    (x - 2)(x - 2.2)(x - 2.4)        x³ - 6.6x² + 14.48x - 10.56 
        ------------------------------- = --------------------------------
        (2.6 - 2)(2.6 - 2.2)(2.6 - 2.4)               0.048

=>

P₃(x) = -10.63125(x³ - 7.2x² + 17.24x - 13.728)
      + 32.55(x³ - 7x² + 16.24x - 12.48)
      - 31.9(x³ - 6.8x² + 15.32x - 11.44)
      + 10.027084(x³ - 6.6x² + 14.48x - 10.56) 

=> P₃(x) = 0.045834x³ - 0.5637544x² + 1.81342632x - 1.22820704

Fazendo P₃(2.5) obtemos 0.49805001.

-> Grau 4:
   
   Utilizando os pontos abaixo para construir o Lagrangiano de grau 4 temos:

   x|   2    |  2.2   |  2.4   |  2.6   |  2.8   |
   -|--------|--------|--------|--------|--------|
   y| 0.5103 | 0.5208 | 0.5104 | 0.4813 | 0.4359 |

P₄(x) = y₀L₀(x) + y₁L₁(x) + y₂L₂(x) + y₃L₃(x) + y₄L₄(x), com:

L₀(x) =    (x - 2.2)(x - 2.4)(x - 2.6)(x - 2.8)          x⁴ - 10x³ + 37.4x² - 62x + 38.4384
        ------------------------------------------ = ------------------------------------------
           (2 - 2.2)(2 - 2.4)(2 - 2.6)(2 - 2.8)                        0.0384

L₁(x) =   (x - 2)(x - 2.4)(x - 2.6)(x - 2.8)           x⁴ - 9.8x³ + 35.84x² - 57.952x + 34.944
        ------------------------------------------ = ------------------------------------------
        (2.2 - 2)(2.2 - 2.4)(2.2 - 2.6)(2.2 - 2.8)                    -0.0096   

L₂(x) =   (x - 2)(x - 2.2)(x - 2.6)(x - 2.8)          x⁴ - 9.6x³ + 34.36x² - 54.336x + 32.032
        ------------------------------------------ = ------------------------------------------
        (2.4 - 2)(2.4 - 2.2)(2.4 - 2.6)(2.4 - 2.8)                     0.0064

L₃(x) =   (x - 2)(x - 2.2)(x - 2.4)(x - 2.8)          x⁴ - 9.4x³ + 32.96x² - 51.104x + 29.568
        ------------------------------------------ = ------------------------------------------
        (2.6 - 2)(2.6 - 2.2)(2.6 - 2.4)(2.6 - 2.8)                    -0.0096

L₄(x) =   (x - 2)(x - 2.2)(x - 2.4)(x - 2.6)          x⁴ - 9.2x³ + 31.64x² - 48.208x + 27.456
        ------------------------------------------ = ------------------------------------------
        (2.8 - 2)(2.8 - 2.2)(2.8 - 2.4)(2.8 - 2.6)                    0.0384

=>

P₄(x) = 13.2890625(x⁴ - 10x³ + 37.4x² - 62x + 38.4384)
      - 54.25(x⁴ - 9.8x³ + 35.84x² - 57.952x + 34.944)
      + 79.75(x⁴ - 9.6x³ + 34.36x² - 54.336x + 32.032)
      - 50.135416(x⁴ - 9.4x³ + 32.96x² - 51.104x + 29.568)
      + 11.3515625(x⁴ - 9.2x³ + 31.64x² - 48.208x + 27.456)

=> P₄(x) = 0.005209x⁴ - 0.0020896x³ - 0.39893636x² + 1.562299264x - 1.085180288


Fazendo P₄(2.5) obtemos 0.4980421845.

Segundamente, utilizando Newton:

-> Grau 2:

   Utilizando a tabela abaixo para construir o polinômio de Newton de grau 2:

   x|   2    |  2.2   |  2.4   |
   -|--------|--------|--------|
   y| 0.5103 | 0.5208 | 0.5104 |

P₂(x) = d₀ + d₁(x - 2) + d₂(x - 2)(x - 2.2)

=>

P₂(x) = d₀ + d₁(x - 2) + d₂(x² - 4.2x + 4.4)

Com dᵢ igual a:

   x    | θ(0)   | θ(1)   |  θ(2)  |
--------|--------|--------|--------|
x₀ = 2  | 0.5103 |        |        |  
        |        | 0.0525 |        |
x₁ = 2.2| 0.5208 |        |-0.26125|
        |        |-0.052  |        |
x₂ = 2.4| 0.5104 |        |        | 

Então d₀ = 0.5103 , d₁ = 0.0525   e d₂ = -0.26125  , ou seja: 

P₂(x) = 0.5103 + 0.0525(x - 2) - 0.26125(x² - 4.2x + 4.4)

=>

P₂(x) = -0.26125x² + 1.14975x - 0.7442

Fazendo P₂(2.5) obtemos 0.4973625.

-> Grau 3:

   Utilizando os pontos da tabela abaixo temos:
   x|   2    |  2.2   |  2.4   |  2.6   |
   -|--------|--------|--------|--------|
   y| 0.5103 | 0.5208 | 0.5104 | 0.4813 |


P₃(x) = d₀ + d₁(x - 2) + d₂(x - 2)(x - 2.2) + d₃(x - 2)(x - 2.2)(x - 2.4)

=>

P₃(x) = d₀ + d₁(x - 2) + d₂(x² - 4.2x + 4.4) + d₃(x³ - 6.6x² + 14.48x - 10.56)

Com dᵢ igual a:

   x    | θ(0)   | θ(1)   | θ(2)   | θ(3)   |
--------|--------|--------|--------|--------|
x₀ = 2  | 0.5103 |        |        |        |   
        |        | 0.0525 |        |        |
x₁ = 2.2| 0.5208 |        |-0.26125|        | 
        |        |-0.052  |        |-0.3875 | 
x₂ = 2.4| 0.5104 |        |-0.49375|        | 
        |        |-0.1455 |        |        |  
x₃ = 2.6| 0.4813 |        |        |        | 

Ou seja, d₀ = 0.5103, d₁ = 0.0525, d₂ = -0.26125 e d₃ = -0.3875

Logo P₃(x) = 0.5103 + 0.0525(x - 2) - 0.26125(x² - 4.2x + 4.4)
           - 0.3875(x³ - 6.6x² + 14.48x - 10.56)

=>

P₃(x) = -0.3875x³ + 2.29625x² - 4.46125x + 3.3478

Fazendo P₃(2.5) obtemos 0.49155.

-> Grau 4:

   Utilizando os pontos da tabela abaixo temos:
   
   x|   2    |  2.2   |  2.4   |  2.6   |  2.8   |
   -|--------|--------|--------|--------|--------|
   y| 0.5103 | 0.5208 | 0.5104 | 0.4813 | 0.4359 |

P₄(x) = d₀ + d₁(x - 2) + d₂(x - 2)(x - 2.2) + d₃(x - 2)(x - 2.2)(x - 2.4) 
      + d₄(x - 2)(x - 2.2)(x - 2.4)(x - 2.6)

=>

P₄(x) = d₀ + d₁(x - 2) + d₂(x² - 4.2x + 4.4) + d₃(x³ - 6.6x² + 14.48x - 10.56)
      + d₄(x⁴ - 9.2x³ + 31.64x² - 48.208x + 27.456) 


   x    | θ(0)   | θ(1)   | θ(2)   | θ(3)   | θ(4)   |
--------|--------|--------|--------|--------|--------|
x₀ = 2  | 0.5103 |        |        |        |        |   
        |        | 0.0525 |        |        |        |   
x₁ = 2.2| 0.5208 |        |-0.26125|        |        |   
        |        |-0.052  |        |-0.3875 |        |   
x₂ = 2.4| 0.5104 |        |-0.49375|        | 1.0885 |   
        |        |-0.1455 |        | 0.4833 |        |   
x₃ = 2.6| 0.4813 |        |-0.20375|        |        |           
        |        |-0.227  |        |        |        |   
x₄ = 2.8| 0.4359 |        |        |        |        |  

Ou seja, d₀ = 0.5103, d₁ = 0.0525, d₂ = -0.26125, d₃ = -0.3875 e d₄ = 1.0885

Logo P₄(x) = 0.5103 + 0.0525(x - 2) - 0.26125(x² - 4.2x + 4.4) 
           - 0.3875(x³ - 6.6x² + 14.48x - 10.56)
           + 1.0885(x⁴ - 9.2x³ + 31.64x² - 48.208x + 27.456) 

=>

P₄(x) = 1.0885*x^4 - 10.4017*x^3 + 36.73639*x^2 - 56.935658*x + 33.233656

Fazendo P₄(2.5) obtemos 0.48991725.

Resumidamente:

         |   n = 2    |    n = 3   |   n = 4      |
Lagrange | 0.4981875  | 0.49805001 | 0.4980421845 |   
---------|------------|------------|--------------|
 Newton  | 0.4973625  | 0.49155    | 0.48991725   |   

### Exercício 3 ###

x| 0 | 1 | 4 |
-|---|---|---|
y| 0 | 1 | 2 |

a)

i)

Assim, P₂(x) = y₀L₀(x) + y₁L₁(x) + y₂L₂(x), com:

   L₀(x) =    (x - 1)(x - 4)          x² - 5x + 4
           -------------------- = --------------------
              (0 - 1)(0 - 4)               4

   L₁(x) =    (x - 0)(x - 4)            x² - 4x
           -------------------- = --------------------
              (1 - 0)(1 - 4)              -3

   L₂(x) =    (x - 0)(x - 1)            x² - x
           -------------------- = --------------------
              (4 - 0)(4 - 1)              12

=>

P₂(x) = 0(x² - 5x + 4) 
      - 0.333(x² - 4x)
      + 0.1666(x² - x)

=> P₂(x) =  -0.1666*x^2  + 1.1666

ii)

x | 0 | 1 | 4 |
--|---|---|---|
y | 0 | 1 | 2 |
--|---|---|---|
y'|10 | 8 | 2 |

   L₀(x) =    (x - 1)(x - 4)          x² - 5x + 4
           -------------------- = --------------------
              (0 - 1)(0 - 4)               4

   L₁(x) =    (x - 0)(x - 4)            x² - 4x
           -------------------- = --------------------
              (1 - 0)(1 - 4)              -3

   L₂(x) =    (x - 0)(x - 1)            x² - x
           -------------------- = --------------------
              (4 - 0)(4 - 1)              12

   L₀'(x) =  2x - 5 
            --------  
               2

   L₁'(x) = 2x - 4
            ------
              -3

   L₂'(x) =  2x - 1
            --------
               12

   H₀(x) =  (1 - 2(2x - 5)(x - 0))(x² - 5x + 4)²  
                  --------         -----------                       
                      2                 4²                                       
     
         = (-2x² + 5x + 1)(x⁴ - 10x³ + 33x² -40x + 16)
                          --------------------------
                                      16
   
   H₁(x) = (1 + 2(2x - 4)(x - 1))(x² - 4x)²       
                 --------         --------
                    3               (-3)²

         =  1*(4x² - 12x + 11)(x⁴ - 8x³ + 16x²)
           ----  
            27

   H₂(x) = (1 - 2(2x - 1)(x - 4))(x² - x)²  
                 --------        --------  
                    12             (12)²
        
         =  1*(-4x² + 18x + 4)(x⁴ - 2x³ + x²)
           ----               
           1728                     

   H̄₀(x) = (x - 0)(x² - 5x + 4)² 
                  -------------
                       4²

         = x(x⁴ - 10x³ + 33x² - 40x + 16)
             ---------------------------
                       16
  
   H̄₁(x) = (x - 1)(x² - 4x)²
                  ----------              
                     (-3)²

         = (x - 1)(x⁴ - 8x³ + 16x²)
                  ---------------
                         9

   H̄₂(x) = (x - 4)(x² - x)²      
                  ---------
                     12²

         = (x - 4)(x⁴ - 2x³ + x²)
                   --------------
                         144


   Ou seja, o polinômio que buscamos, H₅(x) é dado por:
   H₅(x) = 0H₀(x) + 1H₁(x) + 2H₂(x) - 10H̄₀-(x) - 8H̄₁(x) - 2H̄₂(x), em que os polinômios 
   Hi e H̄i, i = 0, 1, 2, foram calculados acima.

   # h5(x) = (4*x^2 - 12*x + 11)*(x^4 -8*x^3 + 16*x^2)/27 +
   2*(-4*x^2 +18*x + 4)*(x^4 -2*x^3 + x^2)/1728 - 
   10*x*(x^4 - 10*x^3 + 33*x^2 - 40*x + 16)/16 -8*(x-1)*(x^4 - 8*x^3 + 16*x^2)/9 
   - 2*(x-4)*(x^4 - 2*x^3 + x^2)/144

iii)

x | 0 | 1 | 4 |
--|---|---|---|
y | 0 | 1 | 2 |
--|---|---|---|
y'|10 | 8 | 2 |


-> Spline linear:
   
   S₁(x) = f(0)(1 - x) + f(1)(x - 0)
               -------       -------
               (1 - 0)       (1 - 0)
        
         = x

   S₂(x) = f(1)(4 - x) + f(2)(x - 1)
               -------       -------
               (4 - 1)       (4 - 1)

         = 4 - x  +  2x - 2
           -----     ------
             3          3
          
         = x + 2
           -----
             3
        
-> Spline cúbica:

   Usando os fatos de que:
   s₁(x) = a₁(x - x₁)³ + b₁(x - x₁)² + c₁(x - x₁) + d₁;
   
   s₂(x) = a₂(x - x₂)³ + b₂(x - x₂)² + c₂(x - x₂) + d₂;

   Para k = 1, 2, temos:
   a₁ = g₁ - g₀ ; b₁ =  g₁  ; c₁ = (f(x₁) - f(x₀) + 2h₁g₁ + g₀h₁) e d₁ = f(x₁)
        -------        ----         -------------   ------------
          6h₁           2                 h₁              6

   a₂ = g₂ - g₁ ; b₂ = g₂  ; c₂ = (f(x₂) - f(x₁) + 2h₂g₂ + g₁h₂) e d₂ = f(x₂)     
       --------       ----         -------------   -------------
          6h₂          2                 h₂              6

   com g₀, g₁ e g₂ a determinar., f(x₀) = 0, f(x₁) = 1 e f(x₂) = 2 e, finalmente,
   h₁ = x₁ - x₀ = 1 e h₂ = x₂ - x₁ = 3, temos então:

   Para k = 1:
   h₁g₀ + 2(h₁ + h₂)g₁ + h₂g₂ = 6(f(x₂) - f(x₁) - f(x₁) - f(x₀))
                                  -------------   -------------
                                        h₂             h₁

   =>

   1g₀ + 8g₁ + 3g₂ = 6( 1  -  1 )
                       ---   ---
                        3     1

   => g₀ + 8g₁ + 3g₂ = -4

   => |1  8  3||g₀| = -4
               |g₁| 
               |g₂| 

      Cujo sistema possui infinitas soluções. Buscando uma solução simples como 
      g₀ = 1, g₁ = -1 e g₂ = 1, s₁ e s₂ não representa os pontos utilizados.
      Porém, outra solução, g₀ = -1, g₁ = 0 e g₂ = -1 o faz.
      Então:
      
      s₁(x) = (x - 1)³ + 5(x - 1) + 1
              -------     -------
                 6           6

      e

      s₂(x) = -(x - 4)³ -(x - 4)² - 2(x - 4) + 2
               -------   -------     -------
                 18         2           3

b) No github.


=#