#=

polinÃ´mios interpoladores:
0.9557546591213079
5.453562457214527
1223.0841070991478

splines lineares:
0.9615384615384616
0.41538461538461546
0.15517241379310343

splines cubicas:
0.954932285334615
0.4357003582723169
0.1646085290162127

=#



z = [-5.0, -4.8, -4.6, -4.4, -4.2, -4.0, 
      -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, 
      -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, 
      -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, 
      -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 
       1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 
       2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 
       4.0, 4.2, 4.4, 4.6, 4.8, 5.0]

function teste1a(z)

# k = 5    

    f(x) = 1 /(1 + 25*x^2)
    p5(x) = 0.00016991193939934363*x^4 - 0.005953714356553001*x^2 + 0.04424534087869215
    
    teste1a = zeros(51)
    for i = 1:51
        teste1a[i] = abs(f(z[i]) - p5(z[i]))
    end
    return maximum(teste1a) # = 0.9557546591213079
end

function teste1b(z)

# k = 10

    f(x) = 1 /(1 + 25*x^2)
    p10(x) = -6.555082721697311e-5*x^10 +  
           0.003607917530022221*x^8 -
           0.06720281294416544*x^6 + 
           0.5038241865915426*x^4 -
           1.4017022018886656*x^2 + 
           0.9999999999999899

    teste1b = zeros(51)
    for i = 1:51
        teste1b[i] = abs(f(z[i]) - p10(z[i]))
    end
    return maximum(teste1b) # = 5.453562457214527

end

function teste1c(z)

# k = 20

    f(x) = 1 /(1 + 25*x^2)
    p20(x) = 6.29303462215807e-8*x^20 -
          2.7811674171541193e-16*x^19 -
          6.0595630376911095e-6*x^18 +
          2.6123368255516376e-14*x^17 +
          0.00024191851089388697*x^16 -
          1.0072972655185325e-12*x^15 -
          0.005215166818428724*x^14 +
          2.0656992996041536e-11*x^13 +
          0.06630522959847931*x^12 -
          2.43929397180434e-10*x^11 -
          0.5103926425832566*x^10 +
          1.6769105057890369e-9*x^9 +
          2.3533842563966894*x^8 -
          6.455692281280344e-9*x^7 -
          6.215554791614401*x^6 +
          1.257453226975886e-8*x^5 +
          8.59245842689197*x^4 -
          9.78647089292887e-9*x^3 - 
          5.24275969496648*x^2 +
          5.584699832407732e-10*x +
          1.0000000005965455

    teste1c = zeros(51)
    for i = 1:51
        teste1c[i] = abs(f(z[i]) - p20(z[i]))
    end
    return maximum(teste1c) # = 1223.0841070991478

end

#x = [-5, -3, -1, 1, 3, 5]
#x = [-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5]
#x = [-5, -4.5, -4, -3.5, -3, -2.5, -2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5]

function teste2a(z)

# k = 5    

    f(x) = 1 /(1 + 25*x^2)
    s1(x) = 0.001413667335802539*x + 0.008665780768469564
    s2(x) = 0.01701837985023826*x + 0.05547991831177672
    s3(x) = 0.038461538461538464
    s4(x) = -0.01701837985023826*x + 0.05547991831177672
    s5(x) = -0.001413667335802539*x + 0.008665780768469564
    
    teste2a = zeros(51)
    for i = 1:11
        teste2a[i] = abs(f(z[i]) - s1(z[i]))
    end
    for i = 12:21
        teste2a[i] = abs(f(z[i]) - s2(z[i]))
    end
    for i = 22:31
        teste2a[i] = abs(f(z[i]) - s3(z[i]))
    end
    for i = 32:41
        teste2a[i] = abs(f(z[i]) - s4(z[i]))
    end
    for i = 42:51
        teste2a[i] = abs(f(z[i]) - s5(z[i]))
    end

    return maximum(teste2a) # = 0.9615384615384616

end

function teste2b(z)

# k = 10 

    f(x) = 1 /(1 + 25*x^2)
    s1(x) = 0.0008963214965780437*x + 0.006079051572347088
    s2(x) = 0.0019310131750270342*x + 0.01021781828614305
    s3(x) = 0.005476211337947954*x + 0.020853412774905808
    s4(x) = 0.02856054836252856*x + 0.06702208682406703
    s5(x) = 0.9615384615384616*x + 1
    s6(x) = -0.9615384615384616*x + 1
    s7(x) = -0.02856054836252856*x + 0.06702208682406703
    s8(x) = -0.005476211337947954*x + 0.020853412774905808
    s9(x) = -0.0019310131750270342*x + 0.01021781828614305
    s10(x) = -0.0008963214965780437*x + 0.006079051572347088


    teste2b = zeros(51)
    for i = 1:6
        teste2b[i] = abs(f(z[i]) - s1(z[i]))
    end
    for i = 7:11
        teste2b[i] = abs(f(z[i]) - s2(z[i]))
    end
    for i = 12:16
        teste2b[i] = abs(f(z[i]) - s3(z[i]))
    end
    for i = 17:21
        teste2b[i] = abs(f(z[i]) - s4(z[i]))
    end
    for i = 22:26
        teste2b[i] = abs(f(z[i]) - s5(z[i]))
    end
    for i = 27:31
        teste2b[i] = abs(f(z[i]) - s6(z[i]))
    end
    for i = 32:36
        teste2b[i] = abs(f(z[i]) - s7(z[i]))
    end
    for i = 37:41
        teste2b[i] = abs(f(z[i]) - s8(z[i]))
    end
    for i = 42:46
        teste2b[i] = abs(f(z[i]) - s9(z[i]))
    end
    for i = 47:51
        teste2b[i] = abs(f(z[i]) - s10(z[i]))
    end
    return maximum(teste2b) # = 0.41538461538461546

end

function teste2c(z)

# k = 20

    f(x) = 1 /(1 + 25*x^2)
    s1(x) = 0.0007479408008792638*x + 0.005337148093853189
    s2(x) = 0.0010447021922768236*x + 0.006672574355142208
    s3(x) = 0.001521826028906578*x + 0.008581069701661226
    s4(x) = 0.0023402003211474903*x + 0.011445379724504417
    s5(x) = 0.0038690434317711787*x + 0.016031909056375485
    s6(x) = 0.00708337924412473*x + 0.024067748587259363
    s7(x) = 0.015132517618574082*x + 0.04016602533615807
    s8(x) = 0.04198857910648304*x + 0.0804501175680215
    s9(x) = 0.1989389920424403*x + 0.23740053050397877
    s10(x) = 1.7241379310344827*x + 1 
    s11(x) = -1.7241379310344827*x + 1
    s12(x) = -0.1989389920424403*x + 0.23740053050397877
    s13(x) = -0.04198857910648304*x + 0.0804501175680215
    s14(x) = -0.015132517618574082*x + 0.04016602533615807
    s15(x) = -0.00708337924412473*x + 0.024067748587259363
    s16(x) = -0.0038690434317711787*x + 0.016031909056375485
    s17(x) = -0.0023402003211474903*x + 0.011445379724504417
    s18(x) = -0.001521826028906578*x + 0.008581069701661226
    s19(x) = -0.0010447021922768236*x + 0.006672574355142208
    s20(x) = -0.0007479408008792638*x + 0.005337148093853189
    teste2c = zeros(51)



    for i = 1:3
        teste2c[i] = abs(f(z[i]) - s1(z[i]))
    end
    for i = 4:5
        teste2c[i] = abs(f(z[i]) - s2(z[i]))
    end
    for i = 6:9
        teste2c[i] = abs(f(z[i]) - s3(z[i]))
    end
    for i = 10:11
        teste2c[i] = abs(f(z[i]) - s4(z[i]))
    end
    for i = 12:14
        teste2c[i] = abs(f(z[i]) - s5(z[i]))
    end
    for i = 15:16
        teste2c[i] = abs(f(z[i]) - s6(z[i]))
    end
    for i = 17:19
        teste2c[i] = abs(f(z[i]) - s7(z[i]))
    end
    for i = 20:21
        teste2c[i] = abs(f(z[i]) - s8(z[i]))
    end
    for i = 22:24
        teste2c[i] = abs(f(z[i]) - s9(z[i]))
    end
    for i = 25:26
        teste2c[i] = abs(f(z[i]) - s10(z[i]))
    end
    for i = 27:29
        teste2c[i] = abs(f(z[i]) - s11(z[i]))
    end
    for i = 30:31
        teste2c[i] = abs(f(z[i]) - s12(z[i]))
    end
    for i = 32:34
        teste2c[i] = abs(f(z[i]) - s13(z[i]))
    end
    for i = 35:36
        teste2c[i] = abs(f(z[i]) - s14(z[i]))
    end
    for i = 37:39
        teste2c[i] = abs(f(z[i]) - s15(z[i]))
    end
    for i = 40:41
        teste2c[i] = abs(f(z[i]) - s16(z[i]))
    end
    for i = 42:44
        teste2c[i] = abs(f(z[i]) - s17(z[i]))
    end
    for i = 45:46
        teste2c[i] = abs(f(z[i]) - s18(z[i]))
    end
    for i = 47:49
        teste2c[i] = abs(f(z[i]) - s19(z[i]))
    end
    for i = 50:51
        teste2c[i] = abs(f(z[i]) - s20(z[i]))
    end

    return maximum(teste2c) # = 0.15517241379310343

end




# k = 20:

function teste3a(z)

# k = 5

    f(x) = 1 /(1 + 25*x^2)
    s1(x) = 0.0012505518739791691*(x + 3)^3 + 
        0.007503311243875014*(x + 3)^2 +
        0.011418082327635892*(x + 3) + 
        0.004424778761061947 
    s2(x) = -0.002351581241286916*(x + 1)^3 -
            0.006606176203846481*(x + 1)^2 +
            0.01321235240769296*(x + 1) + 
            0.038461538461538464
    s3(x) = -0.006606176203846479*(x - 1)^2 -
            0.01321235240769296*(x - 1) + 
            0.038461538461538464
    s4(x) = 0.0023515812412869155*(x - 3)^3 + 
            0.007503311243875014*(x - 3)^2 -
            0.011418082327635894*(x - 3) + 
            0.004424778761061947
    s5(x) = -0.0012505518739791691*(x - 5)^3 + 
            0.0035885401601141375*(x - 5) + 
            0.001597444089456869


    teste3a = zeros(51)
    for i = 1:11
        teste3a[i] = abs(f(z[i]) - s1(z[i]))
    end
    for i = 12:21
        teste3a[i] = abs(f(z[i]) - s2(z[i]))
    end
    for i = 22:31
        teste3a[i] = abs(f(z[i]) - s3(z[i]))
    end
    for i = 32:41
        teste3a[i] = abs(f(z[i]) - s4(z[i]))
    end
    for i = 42:51
        teste3a[i] = abs(f(z[i]) - s5(z[i]))
    end

    return maximum(teste3a) # = 0.954932285334615

end

function teste3b(z)

# k = 10

    f(x) = 1 /(1 + 25*x^2)
    s1(x) = -0.0012236252247443166*(x + 4)^3 -
    0.0036708756742329495*(x + 4)^2 -
    0.0015509289529105894*(x + 4) +
    0.0024937655860349127
    s2(x) = 0.006290574736796413*(x + 3)^3 +
    0.015200848536156292*(x + 3)^2 +
    0.010841286974386913*(x + 3) +
    0.004424778761061947
    s3(x) = -0.02352025597502935*(x + 2)^3 -
        0.055359919388931755*(x + 2)^2 -
        0.026363452075954454*(x + 2) +
        0.009900990099009901
    s4(x) = 0.09104697230693093*(x + 1)^3 +
    0.21778099753186103*(x + 1)^2 +
    0.15529457358745866*(x + 1) +
    0.038461538461538464
    s5(x) = -0.18901870389413564*x^3 -
        0.34927511415054585*x^2 +
        0.8012820512820513*x +
        1
    s6(x) = 0.18901870389413564*(x - 1)^3 +
    0.21778099753186103*(x - 1)^2 -
    0.9327761679007361*(x - 1) +
    0.038461538461538464
    s7(x) = -0.09104697230693093*(x - 2)^3 -
        0.055359919388931755*(x - 2)^2 +
        0.007126504555470613*(x - 2) +
        0.009900990099009901
    s8(x) = 0.02352025597502935*(x - 3)^3 +
    0.01520084853615629*(x - 3)^2 -
    0.013795618776821013*(x - 3) + 
    0.004424778761061947
    s9(x) = -0.006290574736796413*(x - 4)^3 -
        0.003670875674232948*(x - 4)^2 +
        0.0006886858875364303*(x - 4) + 
        0.0024937655860349127
    s10(x) = 0.0012236252247443161*(x - 5)^3 -
        0.0021199467213223596*(x - 5) + 
        0.001597444089456869

    teste3b = zeros(51)

    for i = 1:6
        teste3b[i] = abs(f(z[i]) - s1(z[i]))
    end
    for i = 7:11
        teste3b[i] = abs(f(z[i]) - s2(z[i]))
    end
    for i = 12:16
        teste3b[i] = abs(f(z[i]) - s3(z[i]))
    end
    for i = 17:21
        teste3b[i] = abs(f(z[i]) - s4(z[i]))
    end
    for i = 22:26
        teste3b[i] = abs(f(z[i]) - s5(z[i]))
    end
    for i = 27:31
        teste3b[i] = abs(f(z[i]) - s6(z[i]))
    end
    for i = 32:36
        teste3b[i] = abs(f(z[i]) - s7(z[i]))
    end
    for i = 37:41
        teste3b[i] = abs(f(z[i]) - s8(z[i]))
    end
    for i = 42:46
        teste3b[i] = abs(f(z[i]) - s9(z[i]))
    end
    for i = 47:51
        teste3b[i] = abs(f(z[i]) - s10(z[i]))
    end
    return maximum(teste3b) # = 0.4357003582723169

end

function teste3c(z)

# k = 20

    f(x) = 1 /(1 + 25*x^2)
    s1(x) = 2.375809818412959e-5*(x + 4.5)^3 + 
        3.5637147276194384e-5*(x + 4.5)^2 +
        0.0007598198499713287*(x + 4.5) +
        0.001971414489896501
    s2(x) = -1.987002712146136e-5*(x + 4)^3 +
            5.8321065940023476e-6*(x + 4)^2 +
            0.00105258575235419*(x + 4) +
            0.0024937655860349127
    s3(x) = 0.00011584282537911409*(x + 3.5)^3 +
            0.00017959634466267348*(x + 3.5)^2 +
            0.0015826634948931362*(x + 3.5) +
            0.0032546786004882017
    s4(x) = -0.0003297511225246091*(x + 3)^3 +
            -0.0003150303391242402*(x + 3)^2 +
            0.0022651229322165223*(x + 3) +
            0.004424778761061947
    s5(x) = 0.0014399846041802476*(x + 2.5)^3 +
            0.0018449465671461314*(x + 2.5)^2 +
            0.0044315205642991825*(x + 2.5) +
            0.006359300476947536
    s6(x) = -0.004868356393619761*(x + 2)^3 +
            -0.00545758802328351*(x + 2)^2 +
            0.005571674330887916*(x + 2) +
            0.009900990099009901
    s7(x) = 0.01964504182433073*(x + 1.5)^3 + 
            0.024009974713212586*(x + 1.5)^2 + 
            0.022226244519097695*(x + 1.5) +
            0.017467248908296942
    s8(x) = -0.06744283653254997*(x + 1)^3 +
            -0.07715428008561236*(x + 1)^2 + 
            0.020272148196814357*(x + 1) + 
            0.038461538461538464
    s9(x) = 0.29349108812188524*(x + 0.5)^3 +
            0.36308235209721546*(x + 0.5)^2 +
            0.30710739606057674*(x + 0.5) + 
            0.13793103448275862
    s10(x) = -0.6504386739362958*x^3 +
            -0.6125756588072283*x^2 +
            1.5804597701149425*x + 
            1
    s11(x) = 0.6504386739362958*(x - 0.5)^3 +
            0.3630823520972155*(x - 0.5)^2 -
            1.7052064234699489*(x - 0.5) +
            0.13793103448275862
    s12(x) = -0.29349108812188524*(x - 1)^3 +
            -0.07715428008561236*(x - 1)^2 -
            0.16414336005477517*(x - 1) + 
            0.038461538461538464
    s13(x) = 0.06744283653254997*(x - 1.5)^3 +
            0.02400997471321259*(x - 1.5)^2 -
            0.04684430088301424*(x - 1.5) + 
            0.017467248908296942
    s14(x) = -0.019645041824330734*(x - 2)^3 +
            -0.005457588023283512*(x - 2)^2 -
            0.012950051174133155*(x - 2) + 
            0.009900990099009901
    s15(x) = 0.0048683563936197626*(x - 2.5)^3 +
            0.0018449465671461322*(x - 2.5)^2 -
            0.007377995058956604*(x - 2.5) + 
            0.006359300476947536
    s16(x) = -0.0014399846041802484*(x - 3)^3 +
            -0.00031503033912424046*(x - 3)^2 -
            0.0036665624502882368*(x - 3) +
            0.004424778761061947
    s17(x) = 0.0003297511225246093*(x - 3.5)^3 +
            0.00017959634466267358*(x - 3.5)^2 -
            0.0023328399294473058*(x - 3.5) +
            0.0032546786004882017
    s18(x) = -0.00011584282537911417*(x - 4)^3 +
            5.832106594002323e-6*(x - 4)^2 -
            0.0014899492692647984*(x - 4) +
            0.0024937655860349127
    s19(x) = 1.987002712146138e-5*(x - 4.5)^3 +
            3.563714727619439e-5*(x - 4.5)^2 -
            0.0010318511254190916*(x - 4.5) + 
            0.001971414489896501
    s20(x) = -2.3758098184129594e-5*(x - 5)^3 -
            0.0007420012763332314*(x - 5) +
            0.001597444089456869

    teste3c = zeros(51)

    for i = 1:3
        teste3c[i] = abs(f(z[i]) - s1(z[i]))
    end
    for i = 4:5
        teste3c[i] = abs(f(z[i]) - s2(z[i]))
    end
    for i = 6:9
        teste3c[i] = abs(f(z[i]) - s3(z[i]))
    end
    for i = 10:11
        teste3c[i] = abs(f(z[i]) - s4(z[i]))
    end
    for i = 12:14
        teste3c[i] = abs(f(z[i]) - s5(z[i]))
    end
    for i = 15:16
        teste3c[i] = abs(f(z[i]) - s6(z[i]))
    end
    for i = 17:19
        teste3c[i] = abs(f(z[i]) - s7(z[i]))
    end
    for i = 20:21
        teste3c[i] = abs(f(z[i]) - s8(z[i]))
    end
    for i = 22:24
        teste3c[i] = abs(f(z[i]) - s9(z[i]))
    end
    for i = 25:26
        teste3c[i] = abs(f(z[i]) - s10(z[i]))
    end
    for i = 27:29
        teste3c[i] = abs(f(z[i]) - s11(z[i]))
    end
    for i = 30:31
        teste3c[i] = abs(f(z[i]) - s12(z[i]))
    end
    for i = 32:34
        teste3c[i] = abs(f(z[i]) - s13(z[i]))
    end
    for i = 35:36
        teste3c[i] = abs(f(z[i]) - s14(z[i]))
    end
    for i = 37:39
        teste3c[i] = abs(f(z[i]) - s15(z[i]))
    end
    for i = 40:41
        teste3c[i] = abs(f(z[i]) - s16(z[i]))
    end
    for i = 42:44
        teste3c[i] = abs(f(z[i]) - s17(z[i]))
    end
    for i = 45:46
        teste3c[i] = abs(f(z[i]) - s18(z[i]))
    end
    for i = 47:49
        teste3c[i] = abs(f(z[i]) - s19(z[i]))
    end
    for i = 50:51
        teste3c[i] = abs(f(z[i]) - s20(z[i]))
    end

    return maximum(teste3c)  # = 0.1646085290162127

end